<style>
  .splash-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: black;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    transition: opacity 0.5s;
  }
  .splash-screen.fade-out {
    opacity: 0;
    pointer-events: none;
  }
  .splash-text {
    color: oklch(90% 0.2 340);
    font-size: 24px;
    text-align: center;
    margin: 20px;
    opacity: 0;
  }
  .splash-text:first-child {
    animation: typewriter 1s steps(20) forwards;
  }
  .splash-text:last-child {
    animation: typewriter 1s steps(20) 0.5s forwards;
  }
  @keyframes typewriter {
    from { opacity: 0; }
    to { opacity: 1; }
  }
</style>

<div id="splash-screen" class="splash-screen">
  <div class="splash-text">0XJAH.ME</div>
  <div id="current-date" class="splash-text">LOADING TIME...</div>
</div>

<script>
window.splashManager = window.splashManager || {
  updateDateTime: function() {
    const date = new Date();
    const days = ['SUNDAY', 'MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY', 'SATURDAY'];
    const dayName = days[date.getDay()];
    
    const formattedDate = date.toLocaleDateString('en-US', { 
      year: 'numeric', 
      month: '2-digit', 
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      hour12: false
    }).replace(/\//g, '.').replace(',', '');
    
    return `${dayName} / ${formattedDate}`;
  },

  timeInterval: null,

  cleanup: function() {
    if (this.timeInterval) {
      clearInterval(this.timeInterval);
      this.timeInterval = null;
    }
  },

  startClock: function() {
    const dateElement = document.getElementById('current-date');
    if (!dateElement) return;

    const updateTime = () => {
      if (dateElement && document.body.contains(dateElement)) {
        dateElement.textContent = this.updateDateTime();
      } else {
        this.cleanup();
      }
    };

    this.cleanup(); // Clear any existing interval
    updateTime(); // Update immediately
    this.timeInterval = setInterval(updateTime, 1000);
  },

  initializeSplash: function() {
    const splash = document.getElementById('splash-screen');
    if (!splash) return;

    const dateElement = document.getElementById('current-date');
    if (!dateElement) return;

    // Start the clock after a brief delay
    setTimeout(() => {
      this.startClock();
    }, 500);
  }
};

// Initialize on partial load
document.addEventListener('htmx:afterSwap', function(evt) {
  if (evt.detail.target.querySelector('#splash-screen')) {
    window.splashManager.initializeSplash();
  }
});

// Initialize immediately if we're on the first page load
window.splashManager.initializeSplash();

// Cleanup on navigation
document.addEventListener('htmx:beforeCleanupElement', function(evt) {
  if (evt.target.matches('.splash-screen')) {
    window.splashManager.cleanup();
  }
});
</script>

<script>
  // Cleanup when the splash is removed from the DOM
  document.addEventListener('htmx:beforeCleanupElement', function(evt) {
    if (evt.target.matches('.splash-screen')) {
      evt.target.classList.remove('fade-out');
      evt.target.style.display = '';
    }
  });
</script>
